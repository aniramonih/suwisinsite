<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to remove duplicates on Power BI based on multiple columns? | ZingVlog</title><meta name=generator content="Hugo 0.98.0"><meta name=description content="For example, I have duplicate records that are only differentiated by a column called comments. I am looking to keep duplicate records if they may have the same business line, item name, etc. but if these things are the same and the comment columns are different, I would like to remove these records.
I currently have this calculated column:
IsDuplicate = IF( CALCULATE( COUNTROWS('2023'), FILTER( ALLEXCEPT('2023','2023'[Business Line],'2023'[PD Rating],'2023'[Item Name]), '2023'[Comments] <> EARLIER('2023'[Comments]) ) ) > 0, TRUE, FALSE )  This works exactly as I need and returns &#34;"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/normalize.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/cayman.css><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=./favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=./favicon-16x16.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css integrity=sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js integrity=sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><section class=page-header><h1 class=project-name>ZingVlog</h1><h2 class=project-tagline></h2><nav><a href=./index.html class=btn>Blog</a>
<a href=./sitemap.xml class=btn>Sitemap</a>
<a href=./index.xml class=btn>RSS</a></nav></section><section class=main-content><h1>How to remove duplicates on Power BI based on multiple columns?</h1><div><strong>Publish date: </strong>2024-08-21</div><img src=https://cdn.statically.io/img/cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>For example, I have duplicate records that are only differentiated by a column called comments. I am looking to keep duplicate records if they may have the same business line, item name, etc. but if these things are the same and the comment columns are different, I would like to remove these records.</p><p>I currently have this calculated column:</p><pre><code>IsDuplicate = IF( CALCULATE( COUNTROWS('2023'), FILTER( ALLEXCEPT('2023','2023'[Business Line],'2023'[PD Rating],'2023'[Item Name]), '2023'[Comments] &lt;&gt; EARLIER('2023'[Comments]) ) ) &gt; 0, TRUE, FALSE ) </code></pre><p>This works exactly as I need and returns "TRUE" for the duplicates, but I cannot just remove all of the records returning "TRUE" because this removes the records entirely rather than keeping one and removing just the duplicate.</p><span class=d-none itemprop=commentCount></span><h2 class=mb0 data-answercount=1>1 Answer</h2><p>what about this:</p><pre><code>Duplicate = IF(CALCULATE(COUNT(TABLE[DUPLICATED_COLUMN]), ALLEXCEPT(TABLE, TABLE[DUPLICATED_COLUMN])) &gt; 1 &amp;&amp; TABLE[Date] &gt; CALCULATE(MIN(TABLE[Date]), ALLEXCEPT(TABLE, TABLE[DUPLICATED_COLUMN])), "True", "False") </code></pre><p>Let me explain. The first part:</p><pre><code>CALCULATE(COUNT(TABLE[DUPLICATED_COLUMN]), ALLEXCEPT(TABLE, TABLE[DUPLICATED_COLUMN])) &gt; 1 </code></pre><p>counts the number of occurrences for each value of the column with duplicates. If the value is not duplicated, then the count will return 1, so we want the values greater than 1.</p><p>The second part:</p><pre><code>&amp;&amp; TABLE[Date] &gt; CALCULATE(MIN(TABLE[Date]), ALLEXCEPT(TABLE, TABLE[DUPLICATED_COLUMN])) </code></pre><p>is the filter for the duplicated value you want to keep. In my example, I'm keeping the row where the Date is the minimum. You can change it to any filter you want.</p><p>Finally, if both conditions are met, the formula will return "True" else will return "False". Now you can create a new table like</p><pre><code>RemovedDuplicates = CALCULATETABLE(TABLE, FILTER(TABLE, TABLE[Duplicate] = "False")) </code></pre><span class=d-none itemprop=commentCount></span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJobm9wY2V9dn6OoaawZaSkerOxzKitnmWUqr2ttcKaq56rXaS7brzOsJyrZZKeeqOt0p6bZqeeYrq2uNOip6WdXZi8rcHMp6o%3D</p><footer class=site-footer><span class=site-footer-credits>Made with <a href=https://gohugo.io/>Hugo</a>. Â© 2022. All rights reserved.</span></footer></section><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/tracking_server_3.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>